services:
  dockge:
    image: louislam/dockge:1
    container_name: dockge
    restart: unless-stopped

    ##### ğŸ“‚ VOLUMES #####
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - /opt/stacks:/opt/stacks

    ##### ğŸŒ ENVIRONNEMENT #####
    environment:
      - DOCKGE_STACKS_DIR=/opt/stacks

    ##### ğŸ”— NETWORKING #####
    networks:
      - traefik-net

    ##### ğŸš€ TRAEFIK CONFIGURATION #####
    labels:
      - "traefik.enable=true"

      ##### ğŸŒ ROUTING & DOMAIN #####
      # ğŸ‡«ğŸ‡· Remplacez "dockge.example.ltd" par votre propre domaine
      # ğŸ‡¬ğŸ‡§ Replace "dockge.example.ltd" with your own domain
      - "traefik.http.routers.dockge.rule=Host(`dockge.example.ltd`)"
      - "traefik.http.routers.dockge.entrypoints=https"
      - "traefik.http.routers.dockge.tls.certresolver=letsencrypt"

      ##### ğŸ” RESTRICTION D'ACCÃˆS (OPTIONNEL) #####
      # ğŸ‡«ğŸ‡· Activez cette ligne pour limiter l'accÃ¨s Ã  certaines adresses IP
      # ğŸ‡¬ğŸ‡§ Enable this line to restrict access to specific IP addresses
      #- "traefik.http.routers.dockge.middlewares=dockge-ipwhitelist"

      # ğŸ‡«ğŸ‡· Si vous utilisez un VPN, ajoutez ici vos adresses IP autorisÃ©es
      # ğŸ‡¬ğŸ‡§ If you use a VPN, add your allowed IP addresses here
      #- "traefik.http.middlewares.dockge-ipwhitelist.ipwhitelist.sourcerange=YOURIP1,YOURIP2"

      ##### âš™ï¸ SERVICE CONFIGURATION #####
      # ğŸ‡«ğŸ‡· DÃ©finition du port interne utilisÃ© par Dockge
      # ğŸ‡¬ğŸ‡§ Define the internal port used by Dockge
      - "traefik.http.services.dockge.loadbalancer.server.port=5001"

##### ğŸ”— NETWORK CONFIGURATION #####
networks:
  traefik-net:
    external: true
